---
title: "PopulationData"
author: "Wen Ma"
date: "2/20/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(dplyr)
library(ggplot2)
library(janitor)
```

## R Markdown

Population data for reopened resturants

```{r cars, echo=FALSE}
reopened_resturants = read.csv('../dataset/reopened_resturants.csv', stringsAsFactors = FALSE)
```

## Including Plots

Some tables

```{r one, echo=FALSE}
#Business operation year freq table
kbl(tabyl(reopened_resturants$Business_Operation_Year, sort = TRUE), booktabs = T) %>%
  kable_styling(latex_options = c("striped", "scale-down"))
# 1-5 years owns takes 36% of dataset

#Frachaise
kbl(tabyl(reopened_resturants$Franchise, sort = TRUE), booktabs = T) %>%
  kable_styling(latex_options = c("striped", "scale-down"))
#Even split - 59% Non frachaise vs. 41% frachaise

#Own / Lease
kbl(tabyl(reopened_resturants$Own_Lease, sort = TRUE), booktabs = T) %>%
  kable_styling(latex_options = c("striped", "scale-down"))
#Lease 50%, own 40%, lease to own 10%


#Pricepoint
kbl(tabyl(reopened_resturants$Price_Point_Target, sort = TRUE), booktabs = T) %>%
  kable_styling(latex_options = c("striped", "scale-down"))
#Average 39%, Low-end 40%, High-end 21%

#Dine-in Service
kbl(tabyl(reopened_resturants$Dine_In_Service, sort = TRUE), booktabs = T) %>%
  kable_styling(latex_options = c("striped", "scale-down"))
#70% Y 30% N


#Helpfulness
kbl(tabyl(reopened_resturants$Helpfulness_Factor, sort = TRUE), booktabs = T) %>%
  kable_styling(latex_options = c("striped", "scale-down"))
#average split of 33%
```

Average of income, profit and staff members
```{r two, echo=FALSE}
#Average of everything table
ave_Income2019 <- mean(reopened_resturants$Income_052019_102019)
ave_Income2020 <- mean(reopened_resturants$Income_052020_102020)
ave_Income2021 <- mean(reopened_resturants$Income_052021_102021)
ave_Profit2019 <- mean(reopened_resturants$Profit_052019_102019)
ave_Profit2020 <- mean(reopened_resturants$Profit_052020_102020)
ave_Profit2021 <- mean(reopened_resturants$Profit_052021_102021)
ave_Staff2019 <- mean(reopened_resturants$Number_Of_Staff_Before_Covid)
ave_Staff2020 <- mean(reopened_resturants$Number_Of_Staff_During_Covid)
ave_Staff2021 <- mean(reopened_resturants$Number_Of_Staff_During_Reopen)

average_table <- data.frame("ave_Income2019" = ave_Income2019, 
                            "ave_Income2020" = ave_Income2020, 
                            "ave_Income2021" = ave_Income2021, 
                            "ave_Profit2019" = ave_Profit2019, 
                            "ave_Profit2020" = ave_Profit2020, 
                            "ave_Profit2021" = ave_Profit2021)

average_staff <- data.frame(
                              "ave_Staff2019" = ave_Staff2019, 
                            "ave_Staff2020" = ave_Staff2020, 
                            "ave_Staff2021" = ave_Staff2021
)
kbl(average_table, booktabs = T) %>%
  kable_styling(latex_options = c("striped", "scale-down"))

kbl(average_staff, booktabs = T) %>%
  kable_styling(latex_options = c("striped", "scale-down"))
```


Three year comparison of profits. Red - 2019, Green - 2020, Blue - Reopened 2021
```{r three, echo=FALSE}
ggplot(data = reopened_resturants) +
  geom_histogram(aes(x = Profit_052019_102019, y=(..count..)/sum(..count..)), 
                 alpha=0.3, fill ="red",position="identity") +
  geom_histogram(aes(x = Profit_052020_102020, y=(..count..)/sum(..count..)), 
                 alpha=0.3,, fill ="green",position="identity") +
  geom_histogram(aes(x = Profit_052021_102021, y=(..count..)/sum(..count..)), 
                 alpha=0.7,, fill ="blue",position="identity")
```

Three year comparison of income. Red - 2019, Green - 2020, Blue - Reopened 2021
```{r threehalf, echo=FALSE}
ggplot(data = reopened_resturants) +
  geom_histogram(aes(x = Income_052019_102019, y=(..count..)/sum(..count..)), 
                 alpha=0.3, fill ="red",position="identity") +
  geom_histogram(aes(x = Income_052020_102020, y=(..count..)/sum(..count..)), 
                 alpha=0.3,, fill ="green",position="identity") +
  geom_histogram(aes(x = Income_052021_102021, y=(..count..)/sum(..count..)), 
                 alpha=0.7,, fill ="blue",position="identity")
```

Three year comparison of staff, Red - 2019, Green - 2020, Blue - Reopened 2021
```{r four, echo=FALSE}
ggplot(data = reopened_resturants) +
  geom_histogram(aes(x = Number_Of_Staff_Before_Covid, y=(..count..)/sum(..count..)), 
                 alpha=0.3, fill ="red",position="identity") +
  geom_histogram(aes(x = Number_Of_Staff_During_Covid, y=(..count..)/sum(..count..)), 
                 alpha=0.3,, fill ="green",position="identity") +
  geom_histogram(aes(x = Number_Of_Staff_During_Reopen, y=(..count..)/sum(..count..)), 
                 alpha=0.7,, fill ="blue",position="identity")
```
